define("EventUtil",[],function(){var a=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},b=function(a){return a?a:window.event},c=function(a){return a.target||a.srcElement};return{addHandler:a,getEvent:b,getTarget:c}}),define("canvas",[],function(){var a=document.querySelector(".right"),b=document.createElement("canvas");a.appendChild(b);var c=b.getContext("2d"),d=function(){this.height=0,this.width=0,this.Dots=[],this.sizeFFT=128,this.gradient=null,this.type="Column",this.resize()};return d.prototype.getRandom=function(a,b){return Math.round(Math.random()*(b-a)+a)},d.prototype.getDots=function(){this.Dots=[];for(var a=0;a<this.sizeFFT;a++){var b=this.getRandom(0,this.width),c=this.getRandom(0,this.height),d=(this.getRandom(0,this.height),"rgba("+this.getRandom(0,255)+", "+this.getRandom(0,255)+","+this.getRandom(0,255)+",0)");this.Dots.push({x:b,y:c,dx:this.getRandom(1,4),color:d,cap:0})}},d.prototype.getType=function(){var a=document.querySelector("#button button.selected");return a?a.getAttribute("data-type"):null},d.prototype.resize=function(){this.height=a.clientHeight,this.width=a.clientWidth,b.width=this.width,b.height=this.height,this.getDots(),this.gradient=c.createLinearGradient(0,0,this.width,this.height),this.gradient.addColorStop(0,"red"),this.gradient.addColorStop(.5,"yellow"),this.gradient.addColorStop(1,"green")},d.prototype.drawing=function(a){c.clearRect(0,0,this.width,this.height);var b=this.width/this.sizeFFT,d=.6*b;this.type=this.getType()||"Column";for(var e=0;e<this.sizeFFT;e++){var f=this.Dots[e];if("Column"===this.type){c.fillStyle=this.gradient;var g=a[e]/(3*this.sizeFFT)*this.height;c.fillRect(b*e,this.height-g,d,g),c.fillRect(b*e,this.height-d-f.cap,d,d),f.cap-=4,f.cap<0&&(f.cap=0),g>0&&f.cap<g+40&&(f.cap=g+40>this.height-d?this.height-d:g+40)}else if("Dot"===this.type){c.beginPath();var h=a[e]/(3*this.sizeFFT)*50;f.x+=f.dx,f.x=f.x>this.width?0:f.x,c.arc(f.x,f.y,h,0,2*Math.PI,!1);var i=c.createRadialGradient(f.x,f.y,0,f.x,f.y,h);i.addColorStop(0,"#ffffff"),i.addColorStop(1,f.color),c.fillStyle=i,c.fill()}}},d}),define("createXHR",[],function(){var a=function(){return(a="undefined"!=typeof XMLHttpRequest?function(){return new XMLHttpRequest}:"undefined"!=typeof ActiveXObject?function(){if("String"!==arguments.callee.activeXString){var a,b,c=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"];for(a=0,b=c.length;b>a;a++)try{new ActiveXObject(c[a]),arguments.callee.activeXString=c[a];break}catch(a){}}return new ActiveXObject(arguments.callee.activeXString)}:function(){throw new Error("No XHR object available")})()};return a}),define("MusicVisialer",["./createXHR","./canvas"],function(a,b){var c=function(b){this.count=0,this.source=null,this.analyser=c.ac.createAnalyser(),this.sizeFFT=b.size,this.analyser.fftSize=2*this.sizeFFT,this.gainNode=c.ac[c.ac.createGain?"createGain":"createGainNode"](),this.gainNode.connect(c.ac.destination),this.analyser.connect(this.gainNode),this.xhr=new a,this.analyseFrequency()};return c.ac=new(window.AudioContext||window.webkitAudioContext),c.prototype.load=function(a,b){this.xhr.abort(),this.xhr.open("GET",a),this.xhr.responseType="arraybuffer";var c=this;this.xhr.onload=function(){b(c.xhr.response)},this.xhr.send(null)},c.prototype.decode=function(a,b){c.ac.decodeAudioData(a,function(a){b(a)},function(a){console.log(a)})},c.prototype.play=function(a){var b=++this.count;this.source&&this.source[this.source.stop?"stop":"noteOff"](0);var d=this;this.load(a,function(a){d.decode(a,function(a){if(b===d.count){var e=c.ac.createBufferSource();b===d.count&&(e.buffer=a,e.connect(d.analyser),e[e.start?"start":"noteOn"](0),d.analyseFrequency(),d.source=e)}})})},c.prototype.controlVolume=function(a){this.gainNode.gain.value=a*a},c.prototype.analyseFrequency=function(){function a(){e.analyser.getByteFrequencyData(c),d.drawing(c),requestAnimationFrame(a)}var c=new Uint8Array(this.analyser.frequencyBinCount);requestAnimationFrame=window.requestAnimationFrame||window.webkitrequestAnimationFrame||window.mozrequestAnimationFrame;var d=new b,e=this;requestAnimationFrame(a)},c}),requirejs.config({baseUrl:"../public/javascripts"}),require(["./EventUtil","./canvas","./MusicVisialer"],function(a,b,c){var d=function(){var e=document.querySelector("#music"),f=document.querySelector("#volume"),g=document.querySelector("#button");d.type="Column";var h=128,i=new b,j=new c({size:h});a.addHandler(e,"click",function(b){var c=a.getEvent(b),d=a.getTarget(c),e=document.querySelectorAll("li.selected");if(e)for(var f=0,g=e.length;g>f;f++)e[f].className="";d.className="selected",j.play("/media/"+d.title)}),a.addHandler(f,"change",function(b){var c=a.getEvent(b);a.getTarget(c),j.controlVolume(c.target.value/c.target.max)}),a.addHandler(window,"resize",function(){i.resize()}),a.addHandler(g,"click",function(b){var c=a.getEvent(b),d=(a.getTarget(c),document.querySelector("button.selected"));d&&(d.className=""),c.target.className="selected"})};d()}),define("index",function(){});